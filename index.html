import React, { useEffect, useState } from "react";

/**
 * Portfolio â€“ Uber-clean, professional, and self-contained React page.
 * - No external UI deps; Tailwind-only classes.
 * - Dark/Light toggle.
 * - Polished vertical timeline with media + press logos.
 * - Simple About section.
 * - Runtime self-tests (basic) to catch data issues.
 *
 * Drop assets into /assets/... and update paths below as needed.
 */

export default function Portfolio() {
  const [dark, setDark] = useState(true);
  const [activeMedia, setActiveMedia] = useState(0);

  // --- About Me carousel media (use your real files when ready) ---
  const aboutMedia: { type: "image" | "video"; src: string; caption?: string }[] = [
    { type: "video", src: "/assets/about me.mov", caption: "Intro" },
    { type: "image", src: "/assets/about me r8.JPG", caption: "R8 moment" },
    { type: "image", src: "/assets/about me (cars engine 2jz gte).JPG", caption: "2JZ wrenching" },
    { type: "video", src: "/assets/about me atv.MOV", caption: "ATV fun" },
    { type: "image", src: "/assets/about me dog.JPG", caption: "Life w/ dog" },
    { type: "image", src: "/assets/about me (racing) (pizza being heated on open bonnet of m4 after drifting).HEIC", caption: "Drift day ðŸ•" },
  ];

  // --- Press logos for 2018 activism milestone ---
  const PRESS_LOGOS = [
    { logo: "/assets/logos/timesofindia.png", link: "https://timesofindia.indiatimes.com" },
    { logo: "/assets/logos/indiatoday.png", link: "https://www.indiatoday.in" },
    { logo: "/assets/logos/hindustantimes.png", link: "https://www.hindustantimes.com" },
  ];

  // --- Timeline data (years corrected per your last message) ---
  type TLItem = {
    year: number;
    title: string;
    description: string;
    media?: string; // path to image or video
    press?: { logo: string; link: string }[];
  };

  const timeline: TLItem[] = [
    {
      year: 2013,
      title: "Early Engineering Curiosity",
      description: "Began hands-on work with mechanical parts & tinkering in workshop.",
    },
    {
      year: 2016,
      title: "CAD Modeling Proficiency",
      description: "Taught myself CAD and started creating functional 3D models.",
      media: "/assets/3d printing (cad).jpg",
    },
    {
      year: 2018,
      title: "Climate Activism",
      description:
        "Co-organized Delhi NCR climate strikes; described air pollution as a â€˜millennial cancerâ€™. Coverage by national outlets.",
      media: "/assets/aeromodelling.jpg", // replace with a protest photo if you have one
      press: PRESS_LOGOS,
    },
    {
      year: 2019,
      title: "Aeromodelling Projects",
      description: "Designed & built aeromodelling prototypes, merging climate awareness with engineering.",
      media: "/assets/aeromodelling.jpg",
    },
    {
      year: 2020,
      title: "Workshop Innovation",
      description: "Expanded independent projects (3D printing, small-scale mechanical builds).",
      media: "/assets/a video of me in my workshop at 16!.mp4",
    },
    {
      year: 2023,
      title: "Coding & Motorsport",
      description:
        "Self-taught programming for automation & control. Autocross at Buddh International Circuit â€“ 2nd place.",
      media: "/assets/autocross.jpg",
    },
    {
      year: 2024,
      title: "Lexus GS300 (2JZ) Rebuild",
      description: "Full engine & chassis refresh of a GS300 (2JZ). OEM+ drivability.",
      media: "/assets/projects/gs300.jpg",
    },
    {
      year: 2025,
      title: "UNO MINDA Internship",
      description:
        "Product Integration & Market Analysis â€“ bridging engineering with real-world business impact.",
      media: "/assets/unominda.png",
    },
  ];

  // --- Runtime self-tests (basic) ---
  useEffect(() => {
    // 1) Years should be ascending
    const years = timeline.map((t) => t.year);
    const sorted = [...years].sort((a, b) => a - b);
    if (years.some((y, i) => y !== sorted[i])) {
      // eslint-disable-next-line no-console
      console.warn("Timeline years are not in ascending order:", years);
    }
    // 2) Required milestones present
    const req = [2016, 2018, 2023, 2024, 2025];
    const missing = req.filter((y) => !years.includes(y));
    if (missing.length) {
      // eslint-disable-next-line no-console
      console.warn("Missing required milestones:", missing);
    }
  }, []);

  // --- Helpers ---
  const isVideo = (src?: string) => !!src && /(\.mp4|\.mov|\.heic|\.heif)$/i.test(src);

  return (
    <div className={dark ? "bg-[#0b1220] text-white" : "bg-white text-slate-900"}>
      {/* Top Bar */}
      <header className="sticky top-0 z-20 backdrop-blur bg-black/30 border-b border-white/10">
        <div className="mx-auto max-w-[1150px] px-5 h-16 flex items-center justify-between">
          <div className="flex items-center gap-2 font-semibold tracking-wide">
            <span className="w-2.5 h-2.5 rounded-full bg-gradient-to-br from-cyan-300 to-cyan-400 shadow-[0_0_0_6px_rgba(34,211,238,0.18)]" />
            Aryadhar Gupta
          </div>
          <button
            onClick={() => setDark((d) => !d)}
            className="px-3 py-1.5 rounded-xl border border-white/15 bg-white/5 hover:bg-white/10 transition"
            aria-label="Toggle color mode"
          >
            {dark ? "Light Mode" : "Dark Mode"}
          </button>
        </div>
      </header>

      {/* Hero / Intro */}
      <section className="pt-12 pb-6">
        <div className="mx-auto max-w-[1150px] px-5 grid md:grid-cols-2 gap-8 items-center">
          <div>
            <span className="inline-flex items-center gap-2 text-cyan-300/90 border border-cyan-300/30 bg-cyan-300/10 px-3 py-1 rounded-full text-sm font-semibold">
              Driver â€¢ Builder â€¢ Creator
            </span>
            <h1 className="text-3xl md:text-5xl font-bold leading-tight mt-3">
              I turn engineering and speed into stories.
            </h1>
            <p className="text-slate-300/90 mt-4 max-w-prose">
              Delhi-based motorsport driver & engineer. Formulaâ€‘4 testing, instructor at <strong>BAD BOI DRIFTS</strong>,
              intern at <strong>UNO Minda</strong> (Product Integration & Market Analysis), climate activist featured in
              national media, and handsâ€‘on builder â€” from <em>2JZ</em> restoration to connected hardware and control systems.
              Mensa IQ 145â€“155.
            </p>
            <div className="flex flex-wrap gap-3 mt-5">
              <a href="#timeline" className="px-4 py-2 rounded-xl bg-gradient-to-r from-cyan-300 to-cyan-400 text-[#04121d] font-semibold">
                View Timeline
              </a>
              <a href="#about" className="px-4 py-2 rounded-xl border border-white/15 bg-white/5 hover:bg-white/10 transition">
                About Me
              </a>
            </div>
          </div>

          {/* About carousel */}
          <div id="about" className="rounded-2xl border border-white/10 bg-white/5 p-2 shadow-xl">
            <div className="relative aspect-video overflow-hidden rounded-xl">
              {aboutMedia[activeMedia]?.type === "image" ? (
                // eslint-disable-next-line @next/next/no-img-element
                <img
                  src={aboutMedia[activeMedia].src}
                  alt={aboutMedia[activeMedia].caption || "About media"}
                  className="w-full h-full object-cover"
                />
              ) : (
                <video
                  src={aboutMedia[activeMedia].src}
                  className="w-full h-full"
                  controls
                  playsInline
                />
              )}
            </div>
            <div className="flex items-center justify-between mt-3">
              <div className="text-sm opacity-80">
                {aboutMedia[activeMedia]?.caption}
              </div>
              <div className="flex items-center gap-2">
                {aboutMedia.map((_, i) => (
                  <button
                    key={i}
                    onClick={() => setActiveMedia(i)}
                    className={`w-2.5 h-2.5 rounded-full ${i === activeMedia ? "bg-cyan-300" : "bg-white/30"}`}
                    aria-label={`Go to slide ${i + 1}`}
                  />
                ))}
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Timeline */}
      <section id="timeline" className="py-10">
        <div className="mx-auto max-w-[1150px] px-5">
          <h2 className="text-2xl md:text-3xl font-bold mb-6">Life & Impact Timeline</h2>
          <div className="relative pl-6 md:pl-8">
            {/* vertical line */}
            <div className="absolute left-2 md:left-3 top-0 bottom-0 w-0.5 bg-gradient-to-b from-cyan-300/80 to-transparent" />

            <ul className="space-y-6">
              {timeline.map((item, idx) => (
                <li key={item.year} className="relative">
                  {/* node dot */}
                  <span className="absolute -left-[7px] md:-left-[9px] top-2 w-3 h-3 md:w-3.5 md:h-3.5 rounded-full bg-cyan-300 shadow-[0_0_0_6px_rgba(34,211,238,0.18)]" />

                  <div className="rounded-2xl border border-white/10 bg-white/5 p-4 md:p-5 shadow-lg">
                    <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
                      <div className="text-sm md:text-base font-semibold opacity-80">{item.year}</div>
                      <h3 className="text-lg md:text-xl font-semibold">{item.title}</h3>
                    </div>
                    <p className="mt-2 opacity-90 leading-relaxed">{item.description}</p>

                    {item.media && (
                      <div className="mt-3 overflow-hidden rounded-xl border border-white/10">
                        {isVideo(item.media) ? (
                          <video src={item.media} controls className="w-full" />
                        ) : (
                          // eslint-disable-next-line @next/next/no-img-element
                          <img src={item.media} alt={item.title} className="w-full object-cover" />
                        )}
                      </div>
                    )}

                    {item.press && (
                      <div className="mt-3 flex flex-wrap items-center gap-4">
                        {item.press.map((p) => (
                          <a
                            key={p.logo}
                            href={p.link}
                            target="_blank"
                            rel="noreferrer noopener"
                            className="inline-flex items-center gap-2 opacity-90 hover:opacity-100 transition"
                            aria-label="Press link"
                          >
                            {/* eslint-disable-next-line @next/next/no-img-element */}
                            <img src={p.logo} alt="Press logo" className="h-6 object-contain" />
                          </a>
                        ))}
                      </div>
                    )}
                  </div>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="border-t border-white/10">
        <div className="mx-auto max-w-[1150px] px-5 py-8 text-sm opacity-80 flex flex-col md:flex-row items-start md:items-center justify-between gap-3">
          <div>Â© {new Date().getFullYear()} Aryadhar Gupta</div>
          <div className="space-x-4">
            <a href="#about" className="hover:underline">About</a>
            <a href="#timeline" className="hover:underline">Timeline</a>
          </div>
        </div>
      </footer>
    </div>
  );
}
